name: Deploy site to GitHub Pages
on:
  push:	
    branches:	
      - main

jobs:
  deploy:
    name: Deploy to GitHub Pages
    runs-on: ubuntu-latest    
    steps:
    
    - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
    - run: echo "The name of github.repository is ${{ github.server_url }}/${{ github.repository }}."
    
    - name: Check out repository code
      uses: actions/checkout@master

    - name: Move files into ./pages and check file
      run: mkdir /tmp/pages && cp --recursive ./src/static/* /tmp/pages && mv /tmp/pages ./pages

    - name: List files in the repository
      run: |
        ls ${{ github.workspace }} && tree ./pages

    # Push git subdirectory to gh-pages branch
    - name: Deploy
      uses: s0/git-publish-subdir-action@develop
      env:
        REPO: git@github.com:${{ github.repository }}.git/
        BRANCH: gh-pages
        FOLDER: pages
        GITHUB_TOKEN: ${{ secrets.GHPAGES_TOKEN }}
        #SSH_PRIVATE_KEY: ${{ secrets.DEPLOY_PRIVATE_KEY }}

    - run: echo "üçè This job's status is ${{ job.status }}."
